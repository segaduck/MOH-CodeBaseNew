@using EECOnline.Models
@using EECOnline.Services
@using EECOnline.Commons
@using Turbo.ReportTK
@using Newtonsoft.Json
@{
    ShareCodeListModel sc = new ShareCodeListModel();
    string[] HomeUrl =
    {
        "/",
        "/home",
        "/home/",
        "/home/index",
    };
    string HomeClass = "";
    if (!HomeUrl.Where(x => x == Request.Url.AbsolutePath.TONotNullString().ToLower()).Any())
    {
        HomeClass = "bodybg";
    }

    // 判斷是否由 ReportTK.Controller 查詢檢核失敗導過來, 抓取錯誤訊息
    Report report = (Report)Session[Turbo.Controllers.ReportController.REPORT_SESSION_KEY];
    var reportErrMessage = string.Empty;
    var reportParms = new System.Collections.Hashtable();
    if (report != null)
    {
        if (!string.IsNullOrEmpty(report.ResultMessage))
        {
            reportErrMessage = report.ResultMessage;
            //讀取後清空 report.ResultMessage
            report.ResultMessage = "";
        }
        if (report.QueryParms != null && report.QueryParms.Count > 0)
        {
            foreach (string key in report.QueryParms.Keys)
            {
                reportParms[key] = report.QueryParms[key];
            }
            //讀取後清空 report.QueryParms
            report.QueryParms.Clear();
        }
        // 回存 Report Session
        Session[Turbo.Controllers.ReportController.REPORT_SESSION_KEY] = report;
    }

    //嚐試取得 HTTP 請求導向來源功能編號
    var redirectFromPRGID2 = RedirectToResult.GetRedirectFromLabel(this.Request);

    //取得目前程式功能模組路徑及名稱顯示資訊
    SessionModel sm = SessionModel.Get();
    //Session["USERNAME"] = sm.UserInfo.User.username;
}
<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <title>衛生福利部｜民眾線上申辦電子病歷服務平台</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=8,9,edge,chrome=1">
    <meta name="google-site-verification" content="xO1rl3yyV9pA8bYEEbsrQHV6bsvYiN-OmygfyITWAyQ">
    <meta name="description" content="衛生福利部｜民眾線上申辦電子病歷服務平台">
    <meta name="keywords" content="衛生福利部,民眾,線上申辦,電子病歷,申辦,醫療院所, 進度查詢, 線上繳費">
    <meta name="author" content="">
    <meta name="copyright" content="本網頁著作權屬衛生福利部所有">
    <meta name="robots" content="all">
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta data-n-head="ssr" name="theme-color" content="#0066cc">

    @Styles.Render("~/assests/style/base.css")
    @Styles.Render("~/assests/style/bootstrap.min.css")
    @Scripts.Render("~/assests/js/bootstrap.min.js")
    @*@Scripts.Render("~/assests/js/boxicons.js")*@

    <!-- fontawasome -->
    <link rel="stylesheet" href="~/assests/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="~/assests/css/boxicons.min.css">

    <!-- Favicons -->
    <link href="~/assests/images/favicon.png" rel="icon">
    <link href="~/assests/images/apple-touch-icon.png" rel="apple-touch-icon">

    @Styles.Render("~/Content/owlcarousel")
    @Styles.Render("~/Content/FontBootstrap")
    @Scripts.Render("~/bundles/FrontBootstrapScript")
    @Styles.Render("~/Content/FontBootstrapTable")
    @Scripts.Render("~/bundles/FrontOwlScript")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/Scripts/polyfill/pointer_events_polyfill.js")
    @Scripts.Render("~/Scripts/polyfill/ofi.min.js")
    @Scripts.Render("~/Scripts/global_1.js")

    @*
        @Styles.Render("~/Content/main")
        @Scripts.Render("~/bundles/HCAAPISVI")
    *@
    @*<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />*@
    @*<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>*@

    <script type="text/javascript">
        $(document).ready(function () {
        });

        @* 前一個頁面最後錯誤或結果訊息 *@
        var lastErrorMessage = '@Html.Raw(sm.LastErrorMessage)';
        var lastResultMessage = '@Html.Raw(sm.LastResultMessage)';
        var redirectUrl = '@Html.Raw(sm.RedirectUrlAfterBlock)';
        var reportErrMessage = '@Html.Raw(reportErrMessage)';

        function RedirectAfterPopup(redirectUrlPost) {
            if ((redirectUrlPost != undefined) && (redirectUrlPost != "")) { redirectUrl = redirectUrlPost; }
            if (redirectUrl.length > 0) {
                @*有指定 RedirectUrlAfterBlock, 進行重導動作 *@
                var form = $("form[name=RedirAfterBlockResult]");
                var p = redirectUrl.indexOf("?");
                if (p > 0) {
                    var parms = redirectUrl.substring(p + 1).split("&");
                    redirectUrl = redirectUrl.substring(0, p);
                    for (var i = 0; i < parms.length; i++) {
                        var ptoken = parms[i].split("=");
                        if (ptoken.length == 2) {
                            var input = document.createElement("input");
                            $(input).attr("type", "hidden");
                            $(input).attr("name", ptoken[0]);
                            $(input).attr("value", ptoken[1]);

                            form.append(input);
                        }
                        else {
                            debugTrace("RedirectUrlAfterBlock: parameter syntax error '" + parms[i] + "'");
                        }
                    }
                }
                form.attr("action", redirectUrl);
                form.submit();
            }
            else {
                //20180530 加入使用 HTTP Get 方式導向指定網址
                redirectUrl = "@Html.Raw(sm.RedirectUrlAfterBlockViaGet)";
                if (redirectUrl.length > 0) location.href = redirectUrl;
            }
        }

        $(document).ready(function () {

            @* blockUI 引用的 loading image *@
            // globalSetting.processingImg = "@Url.Content("~/images/processing.gif")";

            @*Report 查詢導回來時的各個查詢條件 binding*@
            var reportParms = $.parseJSON('@Html.Raw(JsonConvert.SerializeObject(reportParms))');
            $.each(reportParms, function (key, value) {
                $("input[name$='" + key + "']")
                    .each(function (idx) {
                        var name = $(this).attr("name");
                        if (name == key || name.lastIndexOf("." + key) > -1) {
                            debugTrace(this);
                            $(this).val(value);
                        }
                    })
                    .trigger('blur');
                $("select[name$='" + key + "']")
                    .each(function (idx) {
                        var name = $(this).attr("name");
                        if (name = key || name.lastIndexOf("." + key) > -1) {
                            debugTrace(this);
                            $(this).val(value);
                        }
                    })
                    .trigger('change');
            });

            @* 前一個頁面最後錯誤或結果訊息 popup 處理*@
            if (lastErrorMessage) {
                blockAlert(lastErrorMessage, "錯誤訊息", function () {
                    RedirectAfterPopup()
                });
            }
            else if (lastResultMessage) {
                blockMessage(lastResultMessage, null, function () {
                    RedirectAfterPopup()
                });
            }
            else if (reportErrMessage) { @*報表核檢或結果訊息*@
                blockAlert(reportErrMessage, "錯誤訊息", function () {
                    RedirectAfterPopup()
                });
            }
            else {
                @* 前一個表單 Post 後的 Validation Summary 訊息顯示 *@
                var IsValid = '@(ViewData.ModelState.IsValid)';
                var validationMsg = $("#ValidationSummary").html();
                if (IsValid == 'False' && validationMsg) {
                    blockAlert(validationMsg, "錯誤訊息");
                }
            }

            @* 設定  div[class='wrap'] 的 min-height *@
            $("div.wrap").css("min-height",
                $("div.container-fluid").innerHeight()
                - $("div.header").outerHeight()
                - $("div.type-bar").outerHeight() +200
                );

        });

    </script>

    <style>
        .disabled_C {
            pointer-events: none;
        }

        .container {
            max-width: 1320px;
        }
    </style>
</head>

<body class="@HomeClass">

    <!--header-->
    @Html.Partial("_MainHeader")
    <!-- header end -->
    <!-- main start -->
    @RenderBody()
    @Html.Partial("_DatePickerFrontTW")
    <!-- main end -->
    <!--footer start -->
    @Html.Partial("_Footer")
    <!--footer end -->

    @Html.Partial("_CommonDialog")

    @* Validation Summary *@
    <div class="hide" id="ValidationSummary">@Html.ValidationSummary()</div>

    <form name="RedirAfterBlockResult" action="" method="POST"></form>

    <style>
        #loadingMask {
            display: none;
            text-align: center;
            padding: 1rem 3rem
        }
    </style>

    @*Loading Mask*@
    <div id="loadingMask">
        <svg class="ani-lightSpeedIn ani-ambulance" xmlns="http://www.w3.org/2000/svg" width="100" @*width="518" height="421.699"*@ viewBox="0 0 518 421.699">
            <g transform="translate(0 -45.001)">
                <path d="M8,426H504c4,0,8-4,8-8V393H0v25C0,422,4,426,8,426Z" fill="#fcf3e3" />
                <path d="M512,122V393H0V337l6-17L0,303V271c0-4,3-8,7-10l26-10c3-1,5-4,6-7L76,119c1-4,5-7,10-7H502A10.021,10.021,0,0,1,512,122Z" fill="#e6f7fe" />
                <path d="M-11307-3792a84,84,0,0,1,51.374-61.587A84,84,0,0,1-11176-3844c9,5,20-1,20-11v-218h21a10.019,10.019,0,0,1,10,10v271Zm-314,0a84,84,0,0,1,82.5-68.2,84,84,0,0,1,82.5,68.2Z" transform="translate(11637 4185)" fill="#d3effd" />
                <path d="M0,337H25a7.887,7.887,0,0,0,8-8V311a7.887,7.887,0,0,0-8-8H0Z" fill="#ffe07d" />
                <path d="M-11290-4040c-2-5-2-11-2-17,0-5,0-11,2-16h181v25c0,4-4,8-8,8Zm-323,0c-4,0-8-4-8-8v-25h181c2,5,2,11,2,16,0,6,0,12-2,17Z" transform="translate(11627 4466)" fill="#f8e7c7" />
                <path d="M-11306.8-4015.8a57.2,57.2,0,0,1,57.2-57.2,57.2,57.2,0,0,1,57.2,57.2,57.2,57.2,0,0,1-57.2,57.2A57.2,57.2,0,0,1-11306.8-4015.8Zm-314.2,0a57.2,57.2,0,0,1,57.2-57.2,57.2,57.2,0,0,1,57.2,57.2,57.2,57.2,0,0,1-57.2,57.2A57.2,57.2,0,0,1-11621-4015.8Z" transform="translate(11662.7 4425.3)" fill="#838383" />
                <path d="M-11307-3995a57,57,0,0,0,69.132-8.869A57,57,0,0,0-11229-4073a57,57,0,0,1,27.284,59.2,57,57,0,0,1-46.09,46.089,57.076,57.076,0,0,1-10.034.891A57.006,57.006,0,0,1-11307-3995Zm-314,0a57,57,0,0,0,69.133-8.869A57,57,0,0,0-11543-4073a56.994,56.994,0,0,1,27.283,59.193,57,57,0,0,1-46.089,46.092,57.1,57.1,0,0,1-10.035.891A57.011,57.011,0,0,1-11621-3995Z" transform="translate(11670 4433)" fill="#5a5a5a" />
                <circle cx="16.6" cy="16.6" r="16.6" transform="translate(82.3 392.9)" fill="#e6f7fe" />
                <circle cx="16.6" cy="16.6" r="16.6" transform="translate(396.5 392.9)" fill="#e6f7fe" />
                <path d="M109,145h57c4,0,8,4,8,8v88a7.887,7.887,0,0,1-8,8H82c-5,0-9-5-7-10l26-88C102,148,106,145,109,145Z" fill="#91dafa" />
                <path d="M143,145V249h23a7.887,7.887,0,0,0,8-8V153c0-4-4-8-8-8Z" fill="#75cff9" />
                <path d="M215,249h17c5,0,8-3,8-8V153a7.887,7.887,0,0,0-8-8H215c-4,0-8,4-8,8v88A7.887,7.887,0,0,0,215,249Z" fill="#6cbff8" />
                <path d="M-11474.5-4040a7.888,7.888,0,0,1-8-8v-17c0-4,4-8,8-8h171a7.885,7.885,0,0,1,8,8v17c0,5-3,8-8,8Zm-139-15a7.5,7.5,0,0,1-7.5-7.5,7.5,7.5,0,0,1,7.5-7.5h14a7.5,7.5,0,0,1,7.5,7.5,7.5,7.5,0,0,1-7.5,7.5Z" transform="translate(11765.5 4345)" fill="#5766cb" />
                <path d="M265,112V89c0-6-4-10-10-10H193c-6,0-11,4-11,10v23Z" fill="#838383" />
                <path d="M-11450-3879a6.454,6.454,0,0,1-6-6v-13a6.452,6.452,0,0,0-6-6h-13a6.454,6.454,0,0,1-6-6v-21a5.765,5.765,0,0,1,6-6h13c3,0,6-3,6-7v-12a5.765,5.765,0,0,1,6-6h21q6,0,6,6v12a6.835,6.835,0,0,0,7,7h12q6,0,6,6v21a5.764,5.764,0,0,1-6,6h-12c-4,0-7,3-7,6v13a5.764,5.764,0,0,1-6,6Zm-171-160,8-26a9.738,9.738,0,0,1,10-8h22c4,0,8,3,10,8l8,26Z" transform="translate(11816 4118)" fill="#e175a5" />
            </g>
        </svg>
        <div class="load-txt">
            <span>處</span>
            <span>理</span>
            <span>中</span>
            <span>.</span>
            <span>.</span>
            <span>.</span>
        </div>
    </div>

    <script>

        $(document).ready(function () {

            //20180827 加入解決 IE 10 以下不支援 CSS3 pointer-events:none 設定問題
            PointerEventsPolyfill.initialize({});

            // 更改enter為tab
            $("input").not($(":button")).keypress(function (evt) {
                if (evt.keyCode == 13) {
                    if ($(this).attr("type") !== 'submit') {
                        var fields = $(this).parents('form:eq(0),body').find('button, input, textarea, select');
                        var index = fields.index(this);
                        if (index > -1 && (index + 1) < fields.length) {
                            fields.eq(index + 1).focus();
                        }
                        $(this).blur();
                        return false;
                    }
                }
            });
        });

        $(function () {
            // 偵測瀏覽器以及 GO TOP調用 (Global)
            wel_medical.init();
        });

        function myFunction() {
            var x = document.getElementById("topnav");
            if (x.className === "header-nav") {
                x.className += " responsive";
            } else {
                x.className = "header-nav";
            }
        }

    </script>

    @*
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="~/assests/js/jquery-3.4.1.min.js"></script>

        <!-- Include all compiled plugins (below), or include individual files as needed -->
        <script src="~/assests/js/popper.min.js"></script>
        <script src="~/assests/js/bootstrap-4.4.1.js"></script>
    *@

</body>

</html>