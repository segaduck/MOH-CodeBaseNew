# 001036 - 專科護理師證書補(換)發 - 服務專屬文件

## 文件說明

本文件說明 **001036 專科護理師證書補(換)發** 服務的專屬特性和差異。

**閱讀順序：**

1. 先閱讀 `_證書補換發服務_共用架構文件.md` 了解共用架構
2. 再閱讀本文件了解 001036 服務的專屬特性

---

## 服務基本資訊

| 項目         | 內容                                                     |
| ------------ | -------------------------------------------------------- |
| 服務代碼     | 001036                                                   |
| 服務名稱     | 專科護理師證書補(換)發                                   |
| 業務單位     | 醫事司                                                   |
| 是否需繳費   | 是                                                       |
| 申請對象     | 已取得專科護理師證書者                                   |
| Controller   | `ES/Controllers/Apply_001036Controller.cs` (361 行)      |
| ViewModel    | `ES/Models/ViewModels/Apply_001036ViewModel.cs` (214 行) |
| Entity Model | `ES/Models/Entities/Apply_001036Model.cs` (117 行)       |
| View         | `ES/Views/Apply_001036/Index.cshtml`                     |
| DAO 方法     | `ApplyDAO.QueryApply_001036()`, `SaveAppDoc001036()`     |
| 主要資料表   | `APPLY`, `APPLY_001036`, `APPLY_FILE`, `APPLY_PAY`       |

---

## 與其他證書補換發服務的比較

| 項目         | 001005 醫事人員證書 | 001007 專科醫師證書 | **001036 專科護理師證書** |
| ------------ | ------------------- | ------------------- | ------------------------- |
| 服務對象     | 醫事人員            | 專科醫師            | **專科護理師**            |
| 證書類別欄位 | DIVISION            | LIC_TYPE            | **DIVISION**              |
| 證書類別數量 | 16 種               | 多種專科            | **專科護理師類別**        |
| 核發單位欄位 | ISSUE_DEPT          | 無                  | **無**                    |
| 繳費方式     | 5 種                | 5 種                | **5 種**                  |
| 補件功能     | 有                  | 有                  | **有**                    |
| 附件上傳     | 1 個檔案            | 1 個檔案            | **1 個檔案**              |
| 郵寄條碼     | 有                  | 有                  | **有**                    |

---

## 服務專屬欄位

### APPLY_001036 資料表專屬欄位

除了共用欄位外，APPLY_001036 資料表還包含以下專屬欄位：

| 欄位名稱 | 資料型別 | 長度 | NULL | 說明               | 範例值 |
| -------- | -------- | ---- | ---- | ------------------ | ------ |
| LIC_TYPE | varchar  | 2    | YES  | 證書類型           | 01     |
| DIVISION | varchar  | 2    | YES  | 專科護理師類別代碼 | 01     |

**欄位說明：**

1. **LIC_TYPE**：證書類型

   - 用於區分不同類型的證書
   - 例如：01=專科護理師證書

2. **DIVISION**：專科護理師類別代碼
   - **這是 001036 的關鍵專屬欄位**
   - 用於儲存專科護理師的類別
   - 與 001005 的 `DIVISION` 欄位功能類似，但代碼值不同

**專科護理師類別代碼 (DIVISION) 對照表：**

| 代碼 | 類別名稱                 | 說明                         |
| ---- | ------------------------ | ---------------------------- |
| 01   | 內科專科護理師           | 內科專科護理師證書           |
| 02   | 外科專科護理師           | 外科專科護理師證書           |
| 03   | 兒科專科護理師           | 兒科專科護理師證書           |
| 04   | 急診專科護理師           | 急診專科護理師證書           |
| 05   | 重症專科護理師           | 重症專科護理師證書           |
| 06   | 精神科專科護理師         | 精神科專科護理師證書         |
| 07   | 社區衛生護理專科護理師   | 社區衛生護理專科護理師證書   |
| 08   | 居家護理專科護理師       | 居家護理專科護理師證書       |
| 09   | 長期照護專科護理師       | 長期照護專科護理師證書       |
| 10   | 安寧緩和護理專科護理師   | 安寧緩和護理專科護理師證書   |
| 11   | 產科專科護理師           | 產科專科護理師證書           |
| 12   | 婦科專科護理師           | 婦科專科護理師證書           |
| 13   | 新生兒科專科護理師       | 新生兒科專科護理師證書       |
| 14   | 麻醉專科護理師           | 麻醉專科護理師證書           |
| 15   | 手術室專科護理師         | 手術室專科護理師證書         |
| 16   | 腎臟透析專科護理師       | 腎臟透析專科護理師證書       |
| 17   | 腫瘤專科護理師           | 腫瘤專科護理師證書           |
| 18   | 感染管制專科護理師       | 感染管制專科護理師證書       |
| 19   | 糖尿病專科護理師         | 糖尿病專科護理師證書         |
| 20   | 心臟血管專科護理師       | 心臟血管專科護理師證書       |
| 21   | 呼吸照護專科護理師       | 呼吸照護專科護理師證書       |
| 22   | 傷口造口及失禁專科護理師 | 傷口造口及失禁專科護理師證書 |
| 23   | 老人專科護理師           | 老人專科護理師證書           |
| 24   | 職業衛生專科護理師       | 職業衛生專科護理師證書       |

---

## ViewModel 專屬屬性

### Apply_001036ViewModel 專屬屬性

```csharp
/// <summary>
/// 專科護理師證書補(換)發 ViewModel
/// </summary>
public class Apply_001036ViewModel : Apply_001036Model
{
    // === 共用屬性（參考共用架構文件）===
    // APPLY_NAME, APPLY_PID, APPLY_DATE, MOBILE, TEL, MAIL, CITY_CODE, CITY_TEXT, CITY_DETAIL 等

    // === 服務專屬屬性 ===

    /// <summary>證書類型代碼</summary>
    public string LIC_TYPE { get; set; }

    /// <summary>證書類型名稱（用於顯示）</summary>
    public string LIC_TYPE_NAME { get; set; }

    /// <summary>專科護理師類別代碼</summary>
    [Display(Name = "專科護理師類別")]
    [Required(ErrorMessage = "請選擇專科護理師類別")]
    public string DIVISION { get; set; }

    /// <summary>專科護理師類別名稱（用於顯示）</summary>
    public string DIVISION_NAME { get; set; }

    /// <summary>專科護理師類別下拉選單資料來源</summary>
    public List<SelectListItem> DivisionList { get; set; }
}
```

---

## Entity Model 專屬屬性

### Apply_001036Model 專屬屬性

```csharp
/// <summary>
/// 專科護理師證書補(換)發 Entity Model
/// 對應資料表：APPLY_001036
/// </summary>
public class Apply_001036Model
{
    // === 共用屬性（參考共用架構文件）===
    public string APP_ID { get; set; }
    public string ACTION_TYPE { get; set; }
    public DateTime? ISSUE_DATE { get; set; }
    public string LIC_CD { get; set; }
    public string LIC_NUM { get; set; }
    public string ACTION_RES { get; set; }
    public string OTHER_RES { get; set; }
    public string EMAIL { get; set; }

    // === 服務專屬屬性 ===

    /// <summary>證書類型</summary>
    [Display(Name = "證書類型")]
    public string LIC_TYPE { get; set; }

    /// <summary>專科護理師類別代碼</summary>
    [Display(Name = "專科護理師類別")]
    public string DIVISION { get; set; }

    // === 標準欄位 ===
    public string DEL_MK { get; set; }
    public DateTime? DEL_TIME { get; set; }
    public string DEL_FUN_CD { get; set; }
    public string DEL_ACC { get; set; }
    public DateTime? UPD_TIME { get; set; }
    public string UPD_FUN_CD { get; set; }
    public string UPD_ACC { get; set; }
    public DateTime? ADD_TIME { get; set; }
    public string ADD_FUN_CD { get; set; }
    public string ADD_ACC { get; set; }
}
```

---

## Controller 專屬實作

### Apply_001036Controller

**檔案位置：** `ES/Controllers/Apply_001036Controller.cs`

**繼承：** BaseController

**主要方法：**

#### 1. Prompt() - 說明事項頁面

```csharp
public ActionResult Prompt()
{
    SessionModel sm = SessionModel.Get();
    string s_msg_1A = "請先閱讀 「{0}說明事項」點選同意後，再進入申辦頁面 !";
    sm.LastErrorMessage = string.Format(s_msg_1A, s_SRV_NAME);
    return View("Prompt001036");
}
```

**說明：**

- 顯示專科護理師證書補(換)發服務說明事項
- 要求使用者閱讀並同意後才能進入申辦頁面

#### 2. Apply() - 申請表單頁面

```csharp
[DisplayName("Apply_001036_申請")]
public ActionResult Apply(string agree)
{
    ApplyDAO dao = new ApplyDAO();
    SessionModel sm = SessionModel.Get();
    Apply_001036ViewModel form = new Apply_001036ViewModel();

    // 檢查登入狀態
    if (sm == null || sm.UserInfo == null || sm.UserInfo.Member == null)
    {
        return RedirectToAction("Index", "Login");
    }

    // 檢查是否同意說明事項
    if (string.IsNullOrEmpty(agree)) { agree = "0"; }
    if (agree != null && !agree.Equals("1")) { return Prompt(); }

    // 帶入會員資訊
    form.APPLY_NAME = sm.UserInfo.Member.NAME;
    form.APPLY_PID = sm.UserInfo.Member.IDN;
    form.BIRTHDAY_AC = HelperUtil.DateTimeToString(sm.UserInfo.Member.BIRTHDAY);

    // 帶入地址資訊
    TblZIPCODE zip = new TblZIPCODE();
    zip.ZIP_CO = sm.UserInfo.Member.TOWN_CD;
    var address = dao.GetRow(zip);
    form.CITY_CODE = sm.UserInfo.Member.TOWN_CD;
    if (address != null)
    {
        form.CITY_TEXT = address.TOWNNM;
        form.CITY_DETAIL = sm.UserInfo.Member.ADDR.TONotNullString().Replace(address.CITYNM + address.TOWNNM, "");
    }

    // 帶入電話資訊
    if (sm.UserInfo.Member.TEL.TONotNullString().Trim() != "")
    {
        string[] tel = sm.UserInfo.Member.TEL.TONotNullString().Split('-');
        form.TEL_SEC = tel[0];
        form.TEL_NO = tel[1].ToSplit('#')[0];

        if (sm.UserInfo.Member.TEL.IndexOf('#') > 0)
        {
            form.TEL_EXT = sm.UserInfo.Member.TEL.Split('#')[1];
        }
    }

    // 帶入 Email 資訊
    if (sm.UserInfo.Member.MAIL.TONotNullString().Trim() != "")
    {
        form.MAIL_ACCOUNT = sm.UserInfo.Member.MAIL.Split('@')[0];
        form.MAIL_DOMAIN = sm.UserInfo.Member.MAIL.Split('@')[1];

        switch (sm.UserInfo.Member.MAIL.Split('@')[1])
        {
            case "gmail.com":
                form.DOMAINList = "1";
                break;
            case "yahoo.com.tw":
                form.DOMAINList = "2";
                break;
            case "outlook.com":
                form.DOMAINList = "3";
                break;
            default:
                form.DOMAINList = "0";
                break;
        }
    }

    form.APPLY_DATE = HelperUtil.DateTimeToTwString(DateTime.Now);
    return View(form);
}
```

**說明：**

- 顯示空白申請表單
- 自動帶入會員基本資料（姓名、身分證字號、生日、地址、電話、Email）
- 處理地址、電話、Email 的格式轉換

#### 3. PreView() - 預覽申請內容

```csharp
[DisplayName("Apply_001036_預覽")]
[HttpPost]
public ActionResult PreView(Apply_001036ViewModel model)
{
    ShareDAO dao = new ShareDAO();
    model.PreView = new Apply_001036ViewModel();
    model.PreView.InjectFrom(model);

    return PartialView("PreView001036", model);
}
```

**說明：**

- 使用 ValueInjecter 複製 model 資料到 PreView 屬性
- 回傳部分視圖顯示預覽內容

#### 4. Pay() - 繳費頁面

```csharp
[DisplayName("Apply_001036_繳費")]
[HttpPost]
public ActionResult Pay(Apply_001036ViewModel model)
{
    ApplyDAO dao = new ApplyDAO();
    model.PreView = new Apply_001036ViewModel();
    model.PreView.InjectFrom(model);
    model.PAY_A_FEE = dao.GetApplyFee("001036");
    model.PAY_METHOD = "";
    return PartialView("Pay", model);
}
```

**說明：**

- 取得服務費用（GetApplyFee）
- 顯示繳費方式選擇頁面

#### 5. Save() - 完成申報

```csharp
[DisplayName("Apply_001036_完成申報")]
[HttpPost]
public ActionResult Save(Apply_001036ViewModel model)
{
    SessionModel sm = SessionModel.Get();
    ApplyDAO dao = new ApplyDAO();
    var memberName = string.IsNullOrWhiteSpace(model.APPLY_NAME) ? sm.UserInfo.Member.NAME : model.APPLY_NAME;
    var memberEmail = string.IsNullOrWhiteSpace(model.MAIL) ? sm.UserInfo.Member.MAIL : model.MAIL;

    switch (model.PAY_METHOD)
    {
        case "C":  // 信用卡線上刷卡
            model.APP_ID = dao.GetApp_ID("001036");
            model.CLIENT_IP = GetClientIP();
            model.ISEC = DataUtils.GetConfig("PAY_EC_OPEN");

            if (!dao.RunCreditCardTranx(model))
            {
                dao.DeleteApplyEmptyRow(model.APP_ID);
                break;
            }
            else
            {
                dao.SendMail_Proc(memberName, memberEmail, model.APP_ID, "專科護理師證書補(換)發", "001036");
            }
            break;

        case "D":  // 匯票
        case "T":  // 劃撥
        case "B":  // 臨櫃
        case "S":  // 超商
            if (!dao.RunPayTranx(model))
            {
                model.ErrorCode = "-1";
                model.ErrorMessage = "繳費執行失敗!!";
                break;
            }
            else
            {
                dao.SendMail_Proc(memberName, memberEmail, model.APP_ID, "專科護理師證書補(換)發", "001036");
            }
            model.ErrorCode = "0000";
            break;
    }

    return View("Save", model);
}
```

**說明：**

- 根據繳費方式執行不同的處理邏輯
- 信用卡：呼叫 `RunCreditCardTranx()`
- 其他方式：呼叫 `RunPayTranx()`
- 寄送通知郵件
- 顯示完成頁面

#### 6. AppDoc() - 補件查詢

```csharp
[DisplayName("Apply_001036_補件查詢")]
public ActionResult AppDoc(string APP_ID)
{
    ApplyDAO dao = new ApplyDAO();
    SessionModel sm = SessionModel.Get();
    Apply_001036ViewModel model = new Apply_001036ViewModel();
    model.APP_ID = APP_ID;
    model = dao.QueryApply_001036(model);

    // 案件基本資訊
    ApplyModel apply = new ApplyModel();
    apply.APP_ID = APP_ID;
    var applyData = dao.GetRow(apply);

    try
    {
        var userInfo = sm.UserInfo.Member;

        // 判斷是否為該案件申請人
        if (applyData.ACC_NO == userInfo.ACC_NO)
        {
            model.IsNotice = "Y";
            ShareDAO shareDAO = new ShareDAO();

            // 檢查是否過補件期限
            if (applyData.FLOW_CD == "2" && shareDAO.CalculationDocDate("001036", model.APP_ID))
            {
                sm.LastErrorMessage = "已過可補件時間，請聯絡承辦單位!!";
                model.IsNotice = "N";
            }

            return View("AppDoc", model);
        }
        else
        {
            throw new Exception("非案件申請人無法瀏覽次案件 !");
        }
    }
    catch (Exception ex)
    {
        if (model == null)
        {
            sm.LastErrorMessage = "案件編號﹕" + APP_ID + "，尚未分派承辦人員，暫無法查詢!!";
            return RedirectToAction("Index", "History");
        }
        else
        {
            sm.LastErrorMessage = ex.Message;
            return RedirectToAction("Index", "Login");
        }
    }
}
```

**說明：**

- 查詢申請案件資料
- 驗證是否為案件申請人
- 檢查是否過補件期限
- 顯示補件頁面

#### 7. AppDocSave() - 補件存檔

```csharp
[DisplayName("Apply_001036_補件存檔")]
[HttpPost]
public ActionResult AppDocSave(Apply_001036ViewModel model)
{
    ApplyDAO dao = new ApplyDAO();
    SessionModel sm = SessionModel.Get();
    var memberName = string.IsNullOrWhiteSpace(model.APPLY_NAME) ? sm.UserInfo.Member.NAME : model.APPLY_NAME;
    var memberEmail = string.IsNullOrWhiteSpace(model.MAIL) ? sm.UserInfo.Member.MAIL : model.MAIL;

    try
    {
        if (dao.SaveAppDoc001036(model))
        {
            dao.SendMail_Update(memberName, memberEmail, model.APP_ID, "專科護理師證書補(換)發", "001036", "-1");
            sm.LastResultMessage = "存檔成功!!";
            model.Apply.FLOW_CD = "3";
        }
        else
        {
            sm.LastErrorMessage = "存檔失敗!!";
        }
    }
    catch (Exception ex)
    {
        logger.Error("Apply_001036_補件存檔__AppDoc failed:" + ex.TONotNullString());
        sm.LastErrorMessage = "存檔失敗!!";
    }

    return View("Done", model);
}
```

**說明：**

- 呼叫 `SaveAppDoc001036()` 儲存補件資料
- 寄送補件完成通知郵件
- 更新流程狀態為「補件完成」(FLOW_CD = "3")
- 顯示完成頁面

#### 8. PayPDF() - 匯出繳費單 PDF

```csharp
public ActionResult PayPDF(string id)
{
    ApplyDAO dao = new ApplyDAO();
    return File(dao.ExportPayPDF(id), "application/pdf", "Pay" + id + ".pdf");
}
```

**說明：**

- 匯出繳費單 PDF 檔案
- 供使用者下載或列印

---

## DAO 專屬實作

### ApplyDAO

**檔案位置：** `ES/DataLayers/ApplyDAO.cs`

#### 1. QueryApply_001036() 方法

**方法簽章：**

```csharp
public Apply_001036ViewModel QueryApply_001036(Apply_001036ViewModel parm)
```

**說明：** 查詢專科護理師證書補(換)發案件資料

**處理流程：**

1. 查詢 APPLY_001036 表取得服務明細資料
2. 查詢 APPLY 表取得案件基本資料
3. 查詢 APPLY_PAY 表取得繳費資料
4. 回傳完整的 ViewModel

**SQL 查詢：**

```sql
-- 查詢服務明細
SELECT APP_ID, ACTION_TYPE, ISSUE_DATE, LIC_TYPE, LIC_CD, LIC_NUM,
       ACTION_RES, OTHER_RES, DEL_MK, DEL_TIME, DEL_FUN_CD, DEL_ACC,
       UPD_TIME, UPD_FUN_CD, UPD_ACC, ADD_TIME, ADD_FUN_CD, ADD_ACC,
       DIVISION, EMAIL
FROM APPLY_001036
WHERE APP_ID = @APP_ID

-- 查詢案件基本資料
SELECT APP_ID, SRV_ID, SRC_SRV_ID, UNIT_CD, ACC_NO, IDN, SEX_CD,
       BIRTHDAY, NAME, ENAME, CNT_NAME, CNT_ENAME, CHR_NAME, CHR_ENAME,
       TEL, FAX, CNT_TEL, ADDR_CODE, ADDR, EADDR, CARD_IDN, APP_TIME,
       PAY_POINT, PAY_METHOD, PAY_BACK_MK, PAY_BACK_DATE, PAY_A_FEE,
       PAY_A_FEEBK, PAY_A_PAID, PAY_C_FEE, PAY_C_FEEBK, PAY_C_PAID,
       CHK_MK, ATM_VNO, API_MK, PRINT_MK, TRANS_ID, MOHW_CASE_NO,
       FLOW_CD, TO_MIS_MK, TO_ARCHIVE_MK, APP_STR_DATE, APP_EXT_DATE,
       APP_ACT_DATE, APP_DEFER_MK, APP_DEFER_TIME_S, APP_DEFER_TIME_E,
       APP_DEFER_DAYS, APP_DEFER_TIMES, APP_DISP_ACC, APP_DISP_MK,
       PRO_ACC, PRO_UNIT_CD, CLOSE_MK, APP_GRADE, APP_GRADE_TIME,
       APP_GRADE_LOG, NOTIFY_COUNT, NOTIFY_TYPE, CASE_BACK_MK,
       CASE_BACK_TIME, DIGITAL, LOGIN_TYPE, DEL_MK, DEL_TIME,
       DEL_FUN_CD, DEL_ACC, UPD_TIME, UPD_FUN_CD, UPD_ACC, ADD_TIME,
       ADD_FUN_CD, ADD_ACC, MARITAL_CD, CERT_SN, MOBILE, ISMODIFY,
       NOTICE_NOTE, MAILBODY
FROM APPLY
WHERE APP_ID = @APP_ID

-- 查詢繳費資料
SELECT APP_ID, PAY_ID, PAY_MONEY, PAY_PROFEE, PAY_ACT_TIME,
       PAY_EXT_TIME, PAY_INC_TIME, PAY_METHOD, PAY_STATUS_MK,
       PAY_RET_CD, PAY_RET_MSG, BATCH_NO, APPROVAL_CD, PAY_RET_NO,
       INVOICE_NO, PAY_DESC, CARD_NO, HOST_TIME, TRANS_RET,
       SESSION_KEY, AUTH_DATE, AUTH_NO, SETTLE_DATE, OTHER, ROC_ID,
       CLIENT_IP, OID, SID, DEL_MK, DEL_TIME, DEL_FUN_CD, DEL_ACC,
       UPD_TIME, UPD_FUN_CD, UPD_ACC, ADD_TIME, ADD_FUN_CD, ADD_ACC
FROM APPLY_PAY
WHERE APP_ID = @APP_ID
```

#### 2. SaveAppDoc001036() 方法

**方法簽章：**

```csharp
public bool SaveAppDoc001036(Apply_001036ViewModel model)
```

**說明：** 儲存專科護理師證書補(換)發補件資料

**處理流程：**

1. 開啟資料庫連線和交易
2. 更新 APPLY 表（姓名、身分證字號、生日、地址、電話、手機）
3. 更新 APPLY_001036 表（專科護理師類別、Email）
4. 處理附件檔案上傳
5. 更新流程狀態為「補件完成」(FLOW_CD = "3")
6. 記錄修改歷程
7. 提交交易
8. 發生錯誤時回滾交易

**關鍵程式碼：**

```csharp
// 更新 APPLY 表
ApplyModel apply = new ApplyModel();
apply.APP_ID = model.APP_ID;
apply.NAME = model.APPLY_NAME;
apply.IDN = model.APPLY_PID;
apply.BIRTHDAY = HelperUtil.TransToDateTime(model.BIRTHDAY_AC);
apply.ADDR_CODE = model.CITY_CODE;
apply.ADDR = model.CITY_TEXT + model.CITY_DETAIL;
apply.TEL = model.TEL_NO.TONotNullString() != "" && model.TEL_SEC.TONotNullString() != "" ?
    (model.TEL_EXT.TONotNullString() != "" ?
        model.TEL_SEC.TONotNullString() + "-" + model.TEL_NO.TONotNullString() + "#" + model.TEL_EXT.TONotNullString() :
        model.TEL_SEC.TONotNullString() + "-" + model.TEL_NO.TONotNullString()) : "";
apply.FLOW_CD = "3";  // 補件完成
apply.ISMODIFY = "A";
apply.UPD_TIME = DateTime.Now;
apply.UPD_FUN_CD = "WEB-APPLY";
apply.MOBILE = model.Apply.MOBILE;
this.Update2(apply, applyWhere, dict2);

// 更新 APPLY_001036 表
Apply_001036Model apply001036 = new Apply_001036Model();
apply001036.APP_ID = model.APP_ID;
apply001036.DIVISION = model.DIVISION;
apply001036.EMAIL = model.MAIL_ACCOUNT + "@" + model.MAIL_DOMAIN.TONotNullString().Replace("@", "");
apply001036.UPD_TIME = DateTime.Now;
apply001036.UPD_FUN_CD = "WEB-APPLY";
this.Update2(apply001036, apply001036Where, dict2);
```

---

## 業務邏輯專屬特性

### 1. 專科護理師類別選擇

**特點：**

- 使用下拉選單選擇專科護理師類別
- 共 24 種專科護理師類別
- 必填欄位

**實作方式：**

```csharp
// Controller 中載入專科護理師類別清單
ShareDAO shareDAO = new ShareDAO();
model.DivisionList = shareDAO.GetCodeList("DIVISION_001036");

// View 中顯示下拉選單
@Html.DropDownListFor(m => m.DIVISION, Model.DivisionList, "請選擇", new { @class = "form-control" })
```

### 2. 繳費方式

**支援的繳費方式：**

1. **信用卡線上刷卡（C）**

   - 使用電子化政府網路付費服務
   - 即時扣款
   - 自動產生繳費證明

2. **匯票（D）**

   - 抬頭：衛生福利部
   - 需郵寄匯票

3. **劃撥（T）**

   - 郵政劃撥
   - 需提供劃撥收據

4. **臨櫃（B）**

   - 現金繳費
   - 至指定地點繳費

5. **超商（S）**
   - 超商繳費
   - 需列印繳費單

### 3. 補件流程

**補件條件：**

- 流程狀態為「補件中」(FLOW_CD = "2")
- 未超過補件期限

**補件內容：**

- 可修改基本資料（姓名、身分證字號、生日、地址、電話、手機）
- 可修改專科護理師類別
- 可修改 Email
- 可重新上傳附件檔案

**補件完成：**

- 更新流程狀態為「補件完成」(FLOW_CD = "3")
- 寄送補件完成通知郵件

---

## 驗證規則專屬特性

### 前端驗證

**必填欄位：**

- 申請人姓名
- 申請人身分證字號
- 生日
- 地址
- 電話
- Email
- 補(換)發原因
- 原證書核發日期
- 原證書字號
- 專科護理師類別（DIVISION）
- 附件檔案

**格式驗證：**

- 身分證字號：台灣身分證格式
- Email：標準 Email 格式
- 電話：區碼-號碼 格式
- 日期：民國年格式

### 後端驗證

**業務邏輯驗證：**

- 檢查專科護理師類別是否有效
- 檢查原證書資料是否完整
- 檢查附件檔案格式（PDF）
- 檢查附件檔案大小（不超過 10MB）

---

## 郵件通知專屬內容

### 申請完成通知

**收件人：** 申請人 Email

**主旨：** 【衛生福利部】專科護理師證書補(換)發申請完成通知

**內容：**

```
親愛的 {申請人姓名} 您好：

您於 {申請日期} 申請的「專科護理師證書補(換)發」已完成申請程序。

案件編號：{APP_ID}
服務名稱：專科護理師證書補(換)發
專科護理師類別：{DIVISION_NAME}
繳費方式：{PAY_METHOD_NAME}
繳費金額：{PAY_A_FEE} 元

您可至「案件查詢」功能查詢案件進度。

如有任何問題，請洽承辦單位。

此為系統自動發送郵件，請勿直接回覆。

衛生福利部 敬上
```

### 補件完成通知

**收件人：** 申請人 Email

**主旨：** 【衛生福利部】專科護理師證書補(換)發補件完成通知

**內容：**

```
親愛的 {申請人姓名} 您好：

您的案件「專科護理師證書補(換)發」補件已完成。

案件編號：{APP_ID}
補件日期：{補件日期}

承辦人員將儘速處理您的案件。

您可至「案件查詢」功能查詢案件進度。

如有任何問題，請洽承辦單位。

此為系統自動發送郵件，請勿直接回覆。

衛生福利部 敬上
```

---

## 與 001005、001007 的關鍵差異

### 1. 服務對象不同

| 服務代碼   | 服務對象       | 證書類別欄位 | 證書類別數量 |
| ---------- | -------------- | ------------ | ------------ |
| 001005     | 醫事人員       | DIVISION     | 16 種        |
| 001007     | 專科醫師       | LIC_TYPE     | 多種專科     |
| **001036** | **專科護理師** | **DIVISION** | **24 種**    |

### 2. 證書類別代碼不同

- **001005**：醫事人員類別（醫師、護理師、藥師等 16 種）
- **001007**：專科醫師類別（內科、外科、兒科等多種專科）
- **001036**：專科護理師類別（內科專科護理師、外科專科護理師等 24 種）

### 3. 資料表結構差異

| 欄位名稱   | 001005 | 001007 | 001036 | 說明         |
| ---------- | ------ | ------ | ------ | ------------ |
| ISSUE_DEPT | ✅     | ❌     | ❌     | 核發單位代碼 |
| LIC_TYPE   | ✅     | ✅     | ✅     | 證書類型     |
| DIVISION   | ✅     | ❌     | ✅     | 證書類別代碼 |

### 4. DAO 方法命名

- **001005**：`QueryApply_001005()`, `SaveAppDoc001005()`
- **001007**：`QueryApply_001007()`, `SaveAppDoc001007()`
- **001036**：`QueryApply_001036()`, `SaveAppDoc001036()`

---

## 相關檔案清單

### 前端檔案

- `ES/Controllers/Apply_001036Controller.cs` (361 行) - 控制器
- `ES/Models/ViewModels/Apply_001036ViewModel.cs` (214 行) - 視圖模型
- `ES/Views/Apply_001036/Prompt001036.cshtml` - 說明事項頁面
- `ES/Views/Apply_001036/Index.cshtml` - 申請表單
- `ES/Views/Apply_001036/PreView001036.cshtml` - 預覽頁面
- `ES/Views/Apply_001036/Pay.cshtml` - 繳費頁面
- `ES/Views/Apply_001036/Save.cshtml` - 完成頁面
- `ES/Views/Apply_001036/AppDoc.cshtml` - 補件頁面
- `ES/Views/Apply_001036/Done.cshtml` - 補件完成頁面

### 後端檔案

- `ES/DataLayers/ApplyDAO.cs` - 資料存取層（包含 QueryApply_001036, SaveAppDoc001036 方法）
- `ES/DataLayers/ShareDAO.cs` - 共用資料存取層
- `ES/Models/Entities/Apply_001036Model.cs` (117 行) - 實體模型
- `ES/Models/Entities/APPLYModel.cs` - APPLY 實體
- `ES/Models/Entities/APPLY_PAY.cs` - APPLY_PAY 實體

### 資料庫資料表

- `SERVICE` - 服務定義表
- `APPLY` - 申請主表
- `APPLY_001036` - 服務明細表
- `APPLY_FILE` - 附件檔案表
- `APPLY_PAY` - 繳費資料表
- `CODE_CD` - 代碼表（專科護理師類別等）

---

## 注意事項

### 1. 專科護理師類別選擇

- 必須選擇專科護理師類別
- 類別代碼必須有效
- 類別名稱會自動帶入

### 2. 繳費方式

- 信用卡繳費需要有效的信用卡資訊
- 其他繳費方式需要後續處理（郵寄匯票、劃撥收據等）
- 繳費完成後才會寄送通知郵件

### 3. 補件功能

- 只有流程狀態為「補件中」的案件才能補件
- 補件有期限限制
- 補件完成後流程狀態會更新為「補件完成」

### 4. 附件檔案

- 只接受 PDF 格式
- 檔案大小不超過 10MB
- 補件時可重新上傳附件

### 5. 郵件通知

- 申請完成後自動寄送通知郵件
- 補件完成後自動寄送通知郵件
- 需要確保 Email 正確

---

**版本：** 1.0
**日期：** 2025-10-20
**作者：** 柏通股份有限公司
