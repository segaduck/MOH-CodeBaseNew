#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     這段程式碼是由工具產生的。
//     執行階段版本:4.0.30319.42000
//
//     對這個檔案所做的變更可能會造成錯誤的行為，而且如果重新產生程式碼，
//     變更將會遺失。
// </auto-generated>
//------------------------------------------------------------------------------

namespace ES.Views.Apply_001008
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Optimization;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    using ES.Helpers;
    
    #line 1 "..\..\Views\Apply_001008\Apply.cshtml"
    using ES.Models;
    
    #line default
    #line hidden
    
    #line 2 "..\..\Views\Apply_001008\Apply.cshtml"
    using ES.Models.ViewModels;
    
    #line default
    #line hidden
    using JQueryUIHelpers;
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/Apply_001008/Apply.cshtml")]
    public partial class Apply : System.Web.Mvc.WebViewPage<Apply_001008FormModel>
    {
        public Apply()
        {
        }
        public override void Execute()
        {
            
            #line 4 "..\..\Views\Apply_001008\Apply.cshtml"
  
    Layout = null;

            
            #line default
            #line hidden
WriteLiteral("\r\n\r\n");

WriteLiteral("\r\n");

            
            #line 9 "..\..\Views\Apply_001008\Apply.cshtml"
 using (Html.BeginForm("Apply", "Apply_001008", FormMethod.Post, htmlAttributes: new { @class = "form-horizontal", id = "main_form", @enctype = "multipart/form-data" }))
{
    
            
            #line default
            #line hidden
            
            #line 11 "..\..\Views\Apply_001008\Apply.cshtml"
Write(Html.FrontControlForTurbo(Model, Model.IsNew));

            
            #line default
            #line hidden
            
            #line 11 "..\..\Views\Apply_001008\Apply.cshtml"
                                                  


            
            #line default
            #line hidden
WriteLiteral("    <h2");

WriteLiteral(" class=\"second-title\"");

WriteLiteral(">\r\n        <span");

WriteLiteral(" style=\"color:red\"");

WriteLiteral(">*</span>醫事人員或公共衛生師/專科中文證書電子檔\r\n");

            
            #line 15 "..\..\Views\Apply_001008\Apply.cshtml"
        
            
            #line default
            #line hidden
            
            #line 15 "..\..\Views\Apply_001008\Apply.cshtml"
         if (Model.FlowMode.Equals("1"))
        {

            
            #line default
            #line hidden
WriteLiteral("            <button");

WriteLiteral(" type=\"button\"");

WriteLiteral(" class=\"btn btn-save\"");

WriteLiteral(" id=\"btnAdd\"");

WriteLiteral(" onclick=\"addGoodRowATHs_()\"");

WriteLiteral(">新增</button>\r\n");

            
            #line 18 "..\..\Views\Apply_001008\Apply.cshtml"
        }

            
            #line default
            #line hidden
WriteLiteral("\r\n    </h2>\r\n");

            
            #line 21 "..\..\Views\Apply_001008\Apply.cshtml"
    
            
            #line default
            #line hidden
            
            #line 21 "..\..\Views\Apply_001008\Apply.cshtml"
                       

            
            #line default
            #line hidden
WriteLiteral("    <div");

WriteLiteral(" id=\"goodsTableAth\"");

WriteLiteral(" class=\"form-set\"");

WriteLiteral(">\r\n        <div");

WriteLiteral(" id=\"row1\"");

WriteLiteral(" data-group=\"goods\"");

WriteLiteral(">\r\n            <div");

WriteLiteral(" class=\"form-group form-inline\"");

WriteLiteral(">\r\n                <label");

WriteLiteral(" id=\"SRL_NOItem\"");

WriteLiteral(" class=\"col-sm-2 step-label\"");

WriteLiteral(">電子檔1</label>\r\n                <div");

WriteLiteral(" class=\"col-sm-7\"");

WriteLiteral(">\r\n                    <input");

WriteLiteral(" type=\"file\"");

WriteLiteral(" id=\"FILE_1_1\"");

WriteLiteral(" name=\"ATHs[0].FILE_1\"");

WriteLiteral(" class=\"form-control\"");

WriteLiteral(" onchange=\"setFileName($(this).attr(\'name\'))\"");

WriteLiteral(">\r\n");

WriteLiteral("                    ");

            
            #line 28 "..\..\Views\Apply_001008\Apply.cshtml"
               Write(Html.HiddenFor(x => x.ATHs[0].FILE_1_FILENAME));

            
            #line default
            #line hidden
WriteLiteral("\r\n");

WriteLiteral("                    ");

            
            #line 29 "..\..\Views\Apply_001008\Apply.cshtml"
               Write(Html.HiddenFor(x => x.ATHs[0].FILE_1_TEXT));

            
            #line default
            #line hidden
WriteLiteral("\r\n");

WriteLiteral("                    ");

            
            #line 30 "..\..\Views\Apply_001008\Apply.cshtml"
               Write(Html.Raw("<br><span style='color:red'>(檔案大小5MB以下，可以接受副檔名：PDF、JPG、BMP、PNG、GIF、TIF)</span>"));

            
            #line default
            #line hidden
WriteLiteral("\r\n                </div>\r\n                <label");

WriteLiteral(" class=\"col-sm-3 form-control-static\"");

WriteLiteral(" for=\"\"");

WriteLiteral(">\r\n                    <button");

WriteLiteral(" type=\"button\"");

WriteLiteral(" id=\"btnDelte_1\"");

WriteLiteral(" class=\"btn btn-clear\"");

WriteLiteral(" onclick=\"deleteGoodRowATHs_($(this))\"");

WriteLiteral(">刪除</button>\r\n                </label>\r\n            </div>\r\n        </div>\r\n     " +
" \r\n    </div>\r\n");

            
            #line 39 "..\..\Views\Apply_001008\Apply.cshtml"

    
            
            #line default
            #line hidden
            
            #line 40 "..\..\Views\Apply_001008\Apply.cshtml"
Write(Html.HiddenFor(m => m.RowCount));

            
            #line default
            #line hidden
            
            #line 40 "..\..\Views\Apply_001008\Apply.cshtml"
                                    
    
            
            #line default
            #line hidden
            
            #line 41 "..\..\Views\Apply_001008\Apply.cshtml"
Write(Html.HiddenFor(m => m.IsUpLoadFile));

            
            #line default
            #line hidden
            
            #line 41 "..\..\Views\Apply_001008\Apply.cshtml"
                                        


            
            #line default
            #line hidden
WriteLiteral("    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"emptyRow\"");

WriteLiteral(" value=\"\"");

WriteLiteral(" />\r\n");

            
            #line 44 "..\..\Views\Apply_001008\Apply.cshtml"


            
            #line default
            #line hidden
WriteLiteral("    <div");

WriteLiteral(" class=\"btn-bar text-center\"");

WriteLiteral(">\r\n        <button");

WriteLiteral(" type=\"button\"");

WriteLiteral(" class=\"btn btn-save\"");

WriteLiteral(" onclick=\"doPreView()\"");

WriteLiteral(">存檔並預覽</button>\r\n        <button");

WriteLiteral(" type=\"reset\"");

WriteLiteral(" class=\"btn btn-clear\"");

WriteLiteral(">清除資料</button>\r\n    </div>\r\n");

            
            #line 49 "..\..\Views\Apply_001008\Apply.cshtml"
    
            
            #line default
            #line hidden
            
            #line 49 "..\..\Views\Apply_001008\Apply.cshtml"
                                          

            
            #line default
            #line hidden
WriteLiteral("    <iframe");

WriteLiteral(" id=\"preViewFrame\"");

WriteLiteral(" name=\"preViewFrame\"");

WriteLiteral(" method=\"post\"");

WriteLiteral(" style=\"display:none\"");

WriteLiteral("></iframe>\r\n");

            
            #line 51 "..\..\Views\Apply_001008\Apply.cshtml"

}

            
            #line default
            #line hidden
WriteLiteral("    <script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(">\r\n    $(document).ready(function () {\r\n        $(\'#emptyRow\').val($(\'#row1\').htm" +
"l());\r\n        $(\'#row1 input[name=\"ATHs[0].SRL_NO\"\').val(\'1\');\r\n        $(\'span" +
" button\').removeAttr(\'disabled\');\r\n    })\r\n\r\n    //檢核\r\n    function doChkCopies(" +
"copiesObj, colName) {\r\n        var copies = copiesObj.value;\r\n\r\n        if (copi" +
"es.length > 0) {\r\n            if (CheckNumeric(copies)) {\r\n                if (c" +
"opies <= 0) {\r\n                    blockAlert(colName + \" 請輸入大於0的份數\", \"提示訊息\", fu" +
"nction () { copiesObj.value = \"\"; });\r\n                } else {\r\n               " +
"     doCountMoney();\r\n                }\r\n            } else {\r\n                /" +
"/debugger;\r\n                blockAlert(colName + \" 請輸入大於0的份數\", \"提示訊息\", function " +
"() { copiesObj.value = \"\"; });\r\n            }\r\n        }\r\n    }\r\n\r\n    //計算金額\r\n " +
"   function doCountMoney() {\r\n        var txtTotalMoney = $(\"#TOTAL_MEM\");\r\n    " +
"    var totalMoney = 0; //合計金額\r\n        var copies = 0; //寄送份數\r\n        var blFi" +
"neMerge = false; //已有整併一張的資料(true:有 / false:無)\r\n        var rdoTypeCDSel = \"\"; /" +
"/開立證明格式類型(1:分別開立 / 2:整併一張)\r\n        var tmpMergeCopies = 0; //份數都要key一樣才能做整併一張\r\n" +
"        var blNotEqualCopies = false;\r\n\r\n        $(\"table#MeGrid > tbody > tr \")" +
".each(function (idx, tr) {\r\n            //debugger;\r\n            var txtCopies =" +
" $(this).find(\"input[id*=\'_\" + idx + \"__ME_COPIES\']\");\r\n            //var rdoTyp" +
"eCDSel = $(this).find(\"input:radio[name*=\'GoodsList[\" + idx + \"].ME_TYPE_CD\']:ch" +
"ecked\").val();\r\n            var typeCDSel = $(this).find(\"select[name*=\'GoodsLis" +
"t[\" + idx + \"].ME_TYPE_CD\'] option:selected\").val();\r\n            //debugger;\r\n " +
"           copies = txtCopies.val();\r\n            if (copies != \"\" && copies > 0" +
") {\r\n                if (typeCDSel == \"1\") {\r\n                    //分別開立(第一份500，" +
"第二份開始每份以200計算)\r\n                    totalMoney += 500;\r\n                    tota" +
"lMoney += --copies * 200;\r\n                } else if (typeCDSel == \"2\") {\r\n     " +
"               //整併一張(不管新增幾筆做整併，只算第一筆整併的第一份500，第二份起算200)\r\n                    if" +
" (tmpMergeCopies == 0) {\r\n                        tmpMergeCopies = copies;\r\n\r\n  " +
"                      if (!blFineMerge) {\r\n                            totalMone" +
"y += 500;\r\n                            totalMoney += --copies * 200;\r\n          " +
"                  blFineMerge = true;\r\n                        }\r\n              " +
"      } else if (tmpMergeCopies != copies) {\r\n                        blNotEqual" +
"Copies = true;\r\n                        txtCopies.val(\"\");\r\n                    " +
"}\r\n                }\r\n            }\r\n        });\r\n\r\n        $(\"table#PrGrid > tb" +
"ody > tr \").each(function (idx, tr) {\r\n            var txtCopies = $(this).find(" +
"\"input[id*=\'_\" + idx + \"__PR_COPIES\']\");\r\n            var typeCDSel = $(this).fi" +
"nd(\"select[name*=\'GoodsList[\" + idx + \"].PR_TYPE_CD\'] option:selected\").val();\r\n" +
"\r\n            copies = txtCopies.val();\r\n            if (copies > 0) {\r\n        " +
"        if (typeCDSel == \"1\") {\r\n                    //分別開立(第一份500，第二份開始每份以200計算" +
")\r\n                    totalMoney += 500;\r\n                    totalMoney += --c" +
"opies * 200;\r\n                } else if (typeCDSel == \"2\") {\r\n                  " +
"  //整併一張(不管新增幾筆做整併，都只算第一筆整併的第一份500，第二份起算200)\r\n                    if (tmpMergeCo" +
"pies == 0) {\r\n                        tmpMergeCopies = copies;\r\n\r\n              " +
"          if (!blFineMerge) {\r\n                            totalMoney += 500;\r\n " +
"                           totalMoney += --copies * 200;\r\n                      " +
"      blFineMerge = true;\r\n                        }\r\n                    } else" +
" if (tmpMergeCopies != copies) {\r\n                        blNotEqualCopies = tru" +
"e;\r\n                        txtCopies.val(\"\");\r\n                    }\r\n         " +
"       }\r\n            }\r\n        });\r\n\r\n        txtTotalMoney.val(totalMoney);\r\n" +
"\r\n        if (blNotEqualCopies) {\r\n            blockAlert(\"開立證明格式選整併一張時，份數需填一致。\"" +
", \"提示訊息\");\r\n        }\r\n    }\r\n\r\n    //存檔並預覽\r\n    function doPreView() {\r\n       " +
" $(\"#IsMode\").val(\"1\"); // 0:新增模式 / 1:瀏覽模式\r\n        $(\"#IsUpLoadFile\").val(\"0\");" +
"\r\n        var data = new FormData($(\'#main_form\')[0]);\r\n        console.log(data" +
");\r\n\r\n        $.ajax({\r\n            url: \'");

            
            #line 161 "..\..\Views\Apply_001008\Apply.cshtml"
             Write(Url.Action("Apply", "Apply_001008"));

            
            #line default
            #line hidden
WriteLiteral("\',\r\n            type: \'POST\',\r\n            cache: false,\r\n            data: data," +
"\r\n            processData: false,\r\n            contentType: false\r\n        }).do" +
"ne(function (res) {\r\n            //debugger;\r\n            if (res.status) {\r\n\r\n " +
"               // 2020.11.17, Eric, 改用 form submit 方式處理 Preview 檔案無法預覽的問題\r\n     " +
"           $(\"#IsUpLoadFile\").val(\"1\");\r\n\r\n                // 綁定 preViewFrame 的 " +
"onload 用來抓取 PreView Action 的回應內容\r\n                $(\'#preViewFrame\').on(\"load\",\r" +
"\n                        function () {\r\n                            contentWin =" +
" document\r\n                                    .getElementById(\'preViewFrame\').c" +
"ontentWindow;\r\n                            debugTrace(\"preViewFrame load: \"\r\n   " +
"                                 + contentWin.location);\r\n\r\n                    " +
"        // 取得 Preview Action 的回應內容\r\n                            var prevewConten" +
"t = contentWin.document.body.innerHTML;\r\n\r\n                            // 串接原本 a" +
"jax 回應後的顯示邏輯\r\n                            $(\'#apply_tab\').removeClass(\'active\');" +
"\r\n                            $(\'#ApplyForm\').attr(\'class\', \'tab-pane fade\');\r\n\r" +
"\n                            $(\'#preview_tab\').attr(\'class\', \'active\');\r\n       " +
"                     $(\'#PreViewForm\').attr(\'class\', \'tab-pane fade active in\');" +
"\r\n\r\n                            $(\"#PreViewForm\").html(prevewContent);\r\n\r\n      " +
"                      //回記錄putfile回傳的檔案存檔路徑資訊\r\n                            $(\"#F" +
"ILE_PAYRECORD_TEXT\").val($(\"#FILE_PAYRECORD_FILENAME\").val());\r\n                " +
"            $(\"#FILE_PASSPORT_TEXT\").val($(\"#FILE_PASSPORT_FILENAME\").val());\r\n " +
"                           //debugger;\r\n                            var index = " +
"0;\r\n                            $(\"input[type=\'hidden\'][name*=\'FILE_1_FULLNAME\']" +
"\").each(function () {\r\n                                //debugger;\r\n            " +
"                    $(\"#ATHs_\" + index + \"__FILE_1_TEXT\").val($(\"#ATHs_\"+index+\"" +
"__FILE_1_FULLNAME\").val());\r\n                                index++;\r\n         " +
"                   });\r\n\r\n                            //反灰效果\r\n                  " +
"          $(\"#GoodsDynamicGird001008Me div.date input\").each(function (i, obj) {" +
"\r\n                                $(\"input[type=\'text\'][id=\'\" + obj.id + \"\']\").a" +
"ttr(\"style\", \"pointer-events:none;background:#EEEEEE\");\r\n                       " +
"     });\r\n\r\n                            $(\"#GoodsDynamicGird001008Pr div.date in" +
"put\").each(function (i, obj) {\r\n                                $(\"input[type=\'t" +
"ext\'][id=\'\" + obj.id + \"\']\").attr(\"style\", \"pointer-events:none;background:#EEEE" +
"EE\");\r\n                            });\r\n\r\n                            //送出 Previ" +
"ew 前如果有 blockUI() 則在這裡解除\r\n                            unblockUI();\r\n            " +
"            });\r\n\r\n                // submit 送出申請表單到 /Apply_001008/PreView\r\n    " +
"            // target 指向 iframe preViewFrame, 讓目前頁面內容維持不變\r\n                var f" +
"orm = $(\'#main_form\');\r\n                var oldAction = form.attr(\"action\");  //" +
" 保存舊值\r\n\r\n                blockUI();\r\n                form\r\n                    ." +
"attr(\"action\", \'");

            
            #line 225 "..\..\Views\Apply_001008\Apply.cshtml"
                                Write(Url.Action("PreView", "Apply_001008"));

            
            #line default
            #line hidden
WriteLiteral("\')\r\n                    .attr(\"target\", \"preViewFrame\")\r\n                    .sub" +
"mit();\r\n\r\n                // 這裡是非同步作業, 在 preViewFrame.onload 事件中去處理回應內容顯示\r\n\r\n   " +
"             // 回存舊值\r\n                form.attr(\"target\", \"\").attr(\"action\", old" +
"Action);\r\n\r\n            }\r\n            else {\r\n                blockAlert(res.me" +
"ssage, \"提示訊息\");\r\n            }\r\n        });\r\n    }\r\n\r\n    //清除資料\r\n    function d" +
"oReset() {\r\n\r\n    }\r\n\r\n    //新增一筆(醫事人員中文證書電子檔)\r\n    function addGoodRowATHs_() {" +
"\r\n        var rowCountObj = $(\'#RowCount\');\r\n        var rowCount = parseInt(row" +
"CountObj.val(), 10) + 1;\r\n        //debugger;\r\n        $(\'#goodsTableAth\').appen" +
"d(\'<div id=\\\"row\' + rowCount + \'\\\" data-group=\\\"goods\\\">\' + $(\'#emptyRow\').val()" +
".replace(/btnDelte_1/gi, \'btnDelte_\' + rowCount).replace(/ATHs\\[0\\]/gi, \'ATHs[\' " +
"+ parseInt(rowCountObj.val(), 10) + \']\').replace(/id=\\\"FILE_1_1/gi, \'id=\"FILE_1_" +
"\' + rowCount).replace(/id=\\\"ATHs_0__FILE_1_/gi, \'id=\\\"ATHs_\'+(rowCount-1)+\'__FIL" +
"E_1_\') + \'</div>\');\r\n        $(\'#row\' + rowCount + \' #SRL_NOItem\').text(\"電子檔\" + " +
"rowCount);\r\n        $(\'#row\' + rowCount + \' input[name=\"ATHs[\' + (rowCount - 1) " +
"+ \'].SRL_NO\"]\').val(rowCount);\r\n        rowCountObj.val(rowCount);\r\n\r\n    }\r\n\r\n " +
"   //刪除(醫事人員中文證書電子檔)\r\n    function deleteGoodRowATHs_(obj) {\r\n        var rowCou" +
"ntObj = $(\'#RowCount\');\r\n        var rowId = $(\'#\' + $(obj).attr(\'id\')).parent()" +
".parent().parent().attr(\'id\');\r\n        $(\'#goodsTableAth #\' + rowId).remove();\r" +
"\n\r\n        var fileSet = $(\'#goodsTableAth div[id^=\"row\"] input[type=\"file\"]\');\r" +
"\n\r\n        if ($(\'#goodsTableAth\').data(\'group\', \'goods\') == null || $(\'#goodsTa" +
"bleAth\').data(\'group\', \'goods\') == undefined) {\r\n            rowCountObj.val(0);" +
"\r\n        }\r\n        else {\r\n            var count = 1;\r\n            for (i = 0;" +
" i < $(\'#goodsTableAth div[id^=\"row\"]\').length; i++) {\r\n                var temp" +
"Html = \'\';\r\n                $($(\'#goodsTableAth div[id^=\"row\"]\')[i]).attr(\'id\', " +
"\'row\' + count);\r\n                $(\'#\' + $($(\'#goodsTableAth div[id^=\"row\"]\')[i]" +
").attr(\'id\') + \' #SRL_NOItem\').text(\"電子檔\" + count);\r\n\r\n                $($(\'#goo" +
"dsTableAth div[id^=\"row\"]\')[i]).find(\'input[type=\"text\"]\').each(function () {\r\n " +
"                   $(this).attr(\'name\', $(this).attr(\'name\').replace(/ATHs\\[[0-9" +
"]+\\]/gi, \'ATHs[\' + i + \']\'));\r\n                })\r\n\r\n                $($(\'#goods" +
"TableAth div[id^=\"row\"]\')[i]).find(\'input[type=\"hidden\"]\').each(function () {\r\n " +
"                   $(this).attr(\'name\', $(this).attr(\'name\').replace(/ATHs\\[[0-9" +
"]+\\]/gi, \'ATHs[\' + i + \']\'));\r\n                })\r\n\r\n                count++;\r\n " +
"           }\r\n\r\n            rowCountObj.val((count - 1));\r\n\r\n            count =" +
" 0\r\n            var rowCount = 1\r\n\r\n            for (i = 0; i < $(fileSet).lengt" +
"h; i++) {\r\n                var tagName = \'\';\r\n                var tagId = \'\'\r\n\r\n" +
"                tagName = \'ATHs[\' + count + \'].FILE_1\';\r\n                tagId =" +
" \'FILE_1_\' + rowCount;\r\n\r\n                rowCount++;\r\n                count++;\r" +
"\n\r\n                $($((fileSet)[i])[0]).attr(\'id\', tagId)\r\n                $($(" +
"(fileSet)[i])[0]).attr(\'name\', tagName)\r\n            }\r\n\r\n            count = 1;" +
"\r\n            var rowCount = 0;\r\n            for (i = 0; i < $(\'#goodsTableAth d" +
"iv[id^=\"row\"]\').length; i++) {\r\n\r\n                var destObjId = $($(\'#goodsTab" +
"leAth div[id^=\"row\"]\')[i]).attr(\'id\')\r\n\r\n                $(\'#\' + $($(\'#goodsTabl" +
"eAth div[id^=\"row\"]\')[i]).attr(\'id\') + \' input[name^=\"ATHs[\' + i + \'].SRL_NO\"]\')" +
".val(count);\r\n\r\n                for (j = 0; j < $(\'#\' + destObjId + \' input[type" +
"=\"file\"]\').length; j++) {\r\n                    var newObj = $(fileSet)[rowCount]" +
";\r\n                    $($($($(\'#\' + destObjId + \' input[type=\"file\"]\')[j]))[0])" +
".replaceWith($(newObj)[0]);\r\n                    setHiddenFileName($($(\'#\' + des" +
"tObjId + \' input[type=\"file\"]\')[j]).attr(\'name\'));\r\n                    rowCount" +
"++\r\n                }\r\n\r\n                count++;\r\n            }\r\n        }\r\n   " +
" }\r\n\r\n    function setFileName(objName) {\r\n        //var validExts = new Array(\"" +
".doc\", \".docx\", \".odt\", \".odf\", \".ods\", \".xls\", \".xlsx\", \".pdf\", \".ppt\", \".pptx\"" +
", \".jpg\", \".bmp\", \".png\", \".gif\", \".tif\", \".zip\");\r\n        var validExts = new " +
"Array(\".PDF\", \".JPG\", \".JPEG\", \".BMP\", \".PNG\", \".GIF\", \".TIF\");\r\n\r\n        var f" +
"ileExt = $(\'input[name=\"\' + objName + \'\"]\').val();\r\n        fileExt = fileExt.su" +
"bstring(fileExt.toLowerCase().lastIndexOf(\'.\'));\r\n\r\n        var errMsg = \"\";\r\n\r\n" +
"        if ($(\'input[name=\"\' + objName + \'\"]\')[0].files[0].size / 1024 / 1024 > " +
"5) {\r\n            errMsg += \"檔案大小不可超過5MB\\n\";\r\n        }\r\n\r\n        if (validExts" +
".indexOf(fileExt.toUpperCase()) < 0) {\r\n            errMsg += \"檔案類型錯誤，可接受的副檔名有：\"" +
" + validExts.toString() + \"\\n\";\r\n        }\r\n\r\n        if (errMsg != \"\") {\r\n     " +
"       blockAlert(errMsg);\r\n            $(\'input[name=\"\' + objName + \'\"]\').val(n" +
"ull);\r\n            return false;\r\n        } else {\r\n            $($(\'input[name=" +
"\"\' + objName + \'\"]\').siblings()[0]).val($(\'input[name=\"\' + objName + \'\"]\').val()" +
".replace(/C:\\\\fakepath\\\\/i, \'\'));\r\n            return true;\r\n        }\r\n    }\r\n\r" +
"\n    function setHiddenFileName(objName) {\r\n        $($(\'input[name=\"\' + objName" +
" + \'\"]\').siblings()[0]).val($(\'input[name=\"\' + objName + \'\"]\').val().replace(/C:" +
"\\\\fakepath\\\\/i, \'\'));\r\n    }\r\n    </script>\r\n\r\n");

        }
    }
}
#pragma warning restore 1591
