@using ES.Services;
@using ES.Areas.Admin.Models;
@model Apply_011010ViewModel

@{
    ViewBag.SRV_NAME = "全國社會工作專業人員選拔推薦";
}

<!--2-->
<div class='panel panel-info'>
    <div class='panel-heading'>
        <h2 class='panel-title' data-toggle='collapse' data-parent='#ApplyData' href='#ApplyData'>
            <a>上傳應附檔案(點擊展開)</a>
        </h2>
    </div>
    <div id='ApplyData' class='panel-collapse collapse'>
        <div class='panel-body'>
            <div class="form-blue">
                <div class="form-group">
                    <label class="main-label col-sm-2" for="">佐證文件採合併檔案</label>
                    <div class="col-sm-10">
                        <label class="radio-inline "><input type="radio" name="MERGEYN" value="Y" @(Model.Form.MERGEYN == "Y" ? "checked" : "") onchange="RadioChange()" disabled>是</label>
                        <label class="radio-inline "><input type="radio" name="MERGEYN" value="N" @(Model.Form.MERGEYN != "Y" ? "checked" : "") onchange="RadioChange()" disabled>否</label>
                        <br />
                        若您是將檔案掃描後，於同一份文件內上傳，請選擇佐證文件採合併檔案"是"，檔案分開上傳請選擇"否"
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-12">
                        <label class="main-label col-sm-2">@Html.DisplayNameFor(m => m.Form.FileList.FILE_EXCEL)</label>
                        <div class="col-sm-10">
                            @Html.FileDLForTurbo(m => m.Form.FileList.FILE_EXCEL, Model.Form.FileList.FILE_EXCEL_TEXT)
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-12">
                        <label class="main-label col-sm-2">@Html.DisplayNameFor(m => m.Form.FileList.FILE_PDF)</label>
                        <div class="col-sm-10">
                            @Html.FileDLForTurbo(m => m.Form.FileList.FILE_PDF, Model.Form.FileList.FILE_PDF_TEXT)
                        </div>
                    </div>
                </div>
                @{
                    var i = 1;
                    if (Model.Form.FileList.SRVLIST != null && Model.Form.FileList.SRVLIST.Count > 0)
                    {
                        foreach (var item in Model.Form.FileList.SRVLIST.GroupBy(x => x.BATCH_INDEX).ToList())
                        {
                            var listNum = i - 1;
                            <div class="form-group">
                                <label class="main-label col-sm-2" for="">推薦表(PDF檔)</label>
                                <label class="main-label col-sm-2" for="">序號-@i</label>
                                <div class="col-sm-8">
                                    @{
                                        for (var detailNum = 1; detailNum < 11; detailNum++)
                                        //顯示補件十次以內上傳的檔案
                                        //foreach (var detail in Model.Form.FileList.SRVLIST.Where(x => x.BATCH_INDEX == (i)).ToList())
                                        {
                                            if (Model.Form.FileList.SRVLIST.Where(x => x.BATCH_INDEX == (i) && x.SRC_NO == detailNum).ToList().Count > 0)
                                            {
                                                @Html.FileDLForTurbo(m => m.Form.FileList.SRVLIST[(listNum)].FILE_3,
 Model.Form.FileList.SRVLIST.Where(x => x.BATCH_INDEX == (i) && x.SRC_NO == detailNum).ToList().FirstOrDefault().FILENAME.Split('\\')[3].ToString() + "," +
 Model.Form.FileList.SRVLIST.Where(x => x.BATCH_INDEX == (i) && x.SRC_NO == detailNum).ToList().FirstOrDefault().APP_ID + "," +
 Model.Form.FileList.SRVLIST.Where(x => x.BATCH_INDEX == (i) && x.SRC_NO == detailNum).ToList().FirstOrDefault().FILE_NO + "," +
 Model.Form.FileList.SRVLIST.Where(x => x.BATCH_INDEX == (i) && x.SRC_NO == detailNum).ToList().FirstOrDefault().SRC_NO + "," + i.ToString())
                                            }
                                        }
                                    }
                                </div>
                            </div>
                            i++;
                        }
                    }
                }
                <div class="btnbar">
                    <button type="button" onclick="GetZip('@Model.Form.FileList.APP_ID')" class="btn btn-blue">檔案打包下載</button>
                </div>
            </div>
        </div>
    </div>
</div>
