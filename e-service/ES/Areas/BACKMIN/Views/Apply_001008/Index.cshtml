@using ES.Areas.Admin.Models;
@model ES.Areas.Admin.Models.Apply_001008FormModel

@{
    Layout = "~/Areas/BACKMIN/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm("Index", "Apply_001008", FormMethod.Post, htmlAttributes: new { @class = "form-horizontal", id = "main_form", @enctype = "multipart/form-data" }))
{
    <div class="bread">
        <i class="fas fa-home"></i>首頁 / 案件分文及處理 / 案件處理 / @(Model.SRV_ID_NAME)
    </div>
    <div class="col-sm-12 content">
        @Html.HiddenFor(m => m.APP_ID)

        <!-- H1 title -->
        <h1 class="main-title"><i class="fas fa-edit"></i>案件審理作業</h1>
        <div class="table-responsive">
            <table width="100%" border="0" cellspacing="0" cellpadding="0" class="table-typeA table">
                <thead>
                    <tr>
                        <th colspan="2">基本資料檔</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td width="20%"><div align="center">申辦項目：</div></td>
                        <td width="80%"><div align="left">@(Model.SRV_ID_NAME)</div></td>
                    </tr>
                    <tr>
                        <td><div align="center">申辦日期：</div></td>
                        <td>@Model.APPLY_DATE_TW</td>
                    </tr>
                    <tr>
                        <td><div align="center">預計完成日：</div></td>
                        <td>@Model.APP_EXT_DATE_TW</td>
                    </tr>
                    <tr>
                        <td><div align="center">案件承辦人姓名：</div></td>
                        <td>@Model.PRO_ACC_NAME</td>
                    </tr>
                    <tr>
                        <td><div align="center">案件編號：</div></td>
                        <td>@Model.APP_ID</td>
                    </tr>
                    <tr>
                        <td><div align="center">系統狀態：</div></td>
                        <td>@Model.APP_STATUS</td>
                    </tr>
                </tbody>
            </table>
        </div>

        @*@Html.ControlForTurbo(Model, Model.IsNew)*@
        @*基本資料檔*@
        <div class='panel panel-info'>
            <div class='panel-heading'>
                <h2 class='panel-title' data-toggle='collapse' data-parent='#basicData'
                    href='#basicData'>
                    <a>基本資料檔(點擊展開)</a>
                </h2>
            </div>
            <div id='basicData' class='panel-collapse collapse'>
                <div class='panel-body'>
                    <div class="form-blue">
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">申辦項目</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(x => x.SRV_ID_NAME, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">申辦日期</label>
                            <div class="col-sm-2">
                                @Html.TextBoxFor(x => x.APPLY_DATE_TW, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">案件編號</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(x => x.APP_ID, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">系統狀態</label>
                            <div class="col-sm-10">
                                @Model.APP_STATUS
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">申請人中文姓名</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(x => x.NAME, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">申請人英文姓名</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(x => x.ENAME, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">申請人英文別名</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(x => x.ENAME_ALIAS, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">身分證編號<br>/居留證號</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(x => x.IDN, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">計算金額</label>
                            <div class="col-sm-2">
                                @Html.TextBoxFor(x => x.TOTAL_MEM, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">通訊地址</label>
                            <div class="col-sm-10  form-inline">
                                @Html.TextBoxFor(m => m.ADDR_ZIP, new { @id = "ADDR_ZIP", @class = "form-10 form-normal form-white", size = 10, placeholder = "郵遞區號", @readonly = "readonly" })
                                <div class="input-group">
                                    @Html.TextBoxFor(m => m.ADDR_ZIP_ADDR, new { @id = "ADDR_ZIP_ADDR", @class = "form-normal form-white", size = 20, placeholder = "郵遞區號名稱", @readonly = "readonly" })
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-info" onclick="doTAX_ORG_CITYSelect()" id="ADDR_SEARCH" disabled><i class="fa fa-search" aria-hidden="true"></i></button>
                                    </span>
                                </div>
                                @Html.TextBoxFor(m => m.ADDR_ZIP_DETAIL, new { @class = "form-normal form-white", placeholder = "請輸入地址 ", size = 59, maxlength = "64", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">連絡電話</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(x => x.TEL, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">行動電話</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(x => x.MOBILE, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">EMAIL</label>
                            <div class="col-sm-10">
                                @Html.EmailForTurbo(x => x.EMAIL, new { @class = "form-control", @readonly = "readonly" }, true)
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">備註</label>
                            <div class="col-sm-6">
                                @Html.TextAreaFor(x => x.REMARK, new { @class = "form-control", @readonly = "readonly", rows = "3", cols = "50" })
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @*醫事人員證書*@
        <div class='panel panel-info'>
            <div class='panel-heading'>
                <h2 class='panel-title' data-toggle='collapse' data-parent='#LicenseData' href='#LicenseData'>
                    <a>醫事人員或公共衛生師證書(點擊展開)</a>
                </h2>
            </div>
            <div id='LicenseData' class='panel-collapse collapse'>
                <div class='panel-body'>
                    <div class="form-horizontal">
                        <div class="form-blue">
                            @Html.EditorFor(m => m.ME, "GoodsDynamicGrid001008Me")
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class='panel panel-info'>
            <div class='panel-heading'>
                <h2 class='panel-title' data-toggle='collapse' data-parent='#SpecialistLicenseData' href='#SpecialistLicenseData'>
                    <a>專科證書(點擊展開)</a>
                </h2>
            </div>
            <div id='SpecialistLicenseData' class='panel-collapse collapse'>
                <div class='panel-body'>
                    <div class="form-horizontal">
                        <div class="form-blue">
                            @Html.EditorFor(m => m.PR, "GoodsDynamicGrid001008Pr")
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @*國內寄送地址*@
        <div class='panel panel-info'>
            <div class='panel-heading'>
                <h2 class='panel-title' data-toggle='collapse' data-parent='#TransData' href='#TransData'>
                    <a>國內寄送地址(點擊展開)</a>
                </h2>
            </div>
            <div id='TransData' class='panel-collapse collapse'>
                <div class='panel-body'>
                    <div class="form-horizontal">
                        <div class="form-blue">
                            @Html.EditorFor(m => m.TRANS, "GoodsDynamicGrid001008Trans")
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @*國外寄送地址*@
        <div class='panel panel-info'>
            <div class='panel-heading'>
                <h2 class='panel-title' data-toggle='collapse' data-parent='#TransFData' href='#TransFData'>
                    <a>國外寄送地址(點擊展開)</a>
                </h2>
            </div>
            <div id='TransFData' class='panel-collapse collapse'>
                <div class='panel-body'>
                    <div class="form-horizontal">
                        <div class="form-blue">
                            @Html.EditorFor(m => m.TRANSF, "GoodsDynamicGrid001008TransF")
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @*上傳應附檔案*@
        @Html.Partial("File")

        <div class='panel panel-info'>
            <div class='panel-heading'>
                <h2 class='panel-title' data-toggle='collapse' data-parent='#PayData'
                    href='#PayData'>
                    <a>繳費情形(點擊展開)</a>
                </h2>
            </div>
            <div id='PayData' class='panel-collapse collapse'>
                <div class='panel-body'>
                    <div class="form-blue">
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">繳費方式</label>
                            <div class="col-sm-4">
                                @Html.HiddenFor(m => m.PAY_METHOD)
                                @Html.TextBoxFor(m => m.PAY_METHOD_NAME, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">申辦日期</label>
                            <div class="col-sm-4">
                                @Html.DatePickerTWFor(m => m.PAY_ACT_TIME_AC, new { size = "10", @readonly = "readonly", @disabled = "disabled" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">繳費金額</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(m => m.Apply.PAY_A_FEE, new { @class = "form-control", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">交易日期</label>
                            <div class="col-sm-4">
                                @*已繳費不能再異動繳費日期*@
                                @if ("Y".Equals(Model.IsPay))
                                {
                                    @Html.DatePickerTWFor(m => m.PAY_EXT_TIME_AC, new { size = "10", @readonly = "readonly", @disabled = "disabled" })
                                }
                                else
                                {
                                    @Html.DatePickerTWFor(m => m.PAY_EXT_TIME_AC, new { size = "10", @dateTimePickerShowCallback = "dateTimePickerShowCallback" })
                                }
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">交易金額</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(m => m.PAY_MONEY, new { @class = "form-control", @readonly = "readonly" })
                                @Html.CheckBoxFor(x => x.IsPay)已繳費
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class='panel panel-info'>
            <div class='panel-heading'>
                <h2 class='panel-title' data-toggle='collapse' data-parent='#ReviewData' href='#ReviewData'>
                    <a>案件進度歷程(點擊展開)</a>
                </h2>
            </div>

            <div id='ReviewData' class='panel-collapse collapse'>
                <div class='panel-body'>
                    <div class="form-blue">
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">案件進度</label>
                            <div class="col-sm-4">
                                <input type="text" id="StatusDesc" class="form-control" readonly value="">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">案件狀態修改</label>
                            <div class="col-sm-4">
                                @Html.DropDownListFor(m => m.FLOW_CD, Model.FLOW_CD_list, new { @class = "form-control", onchange = "changeAppDocCheck()" })
                            </div>
                        </div>

                        <div id="notice" style="display:none">
                            <div class="form-group" id="notice_item">
                                <label class="main-label col-sm-2" for="">補件項目</label>
                                <div class="col-sm-4">
                                    <input type="checkbox" id="chkNotice1" onchange="checkNotice()" value="0"><label for="chkNotice1">繳費紀錄照片或pdf檔案</label><br />
                                    <input type="checkbox" id="chkNotice2" onchange="checkNotice()" value="1"><label for="chkNotice2">護照影本電子檔</label><br />
                                    <input type="checkbox" id="chkNotice3" onchange="checkNotice()" value="2"><label for="chkNotice3">醫事人員或公共衛生師/專科中文證書電子檔</label><br />
                                    <input type="checkbox" id="chkNotice4" onchange="checkNotice()" name="chkNotice" value="3"><label for="chkNotice4">其他</label>
                                    @Html.HiddenFor(m => m.ISMODIFY)
                                    @*@Html.HiddenFor(x => x.NoticeCheck)*@
                                </div>
                            </div>
                            <div class="form-group" id="note_content">
                                <label class="main-label col-sm-2" id="remarkTitle" for="">補件內容</label>
                                <div class="col-sm-4">
                                    @Html.TextAreaFor(m => m.Note, new { @class = "form-control" })
                                </div>
                            </div>

                            @*<div class="form-group">
                                <label class="main-label col-sm-2" for="">補件項目</label>
                                <div class="col-sm-4" style="padding:0px;">
                                    <input type="checkbox" id="chkNotice1" onchange="checkNotice()" value="0"><label for="chkNotice1">繳費紀錄照片或pdf檔案</label>
                                </div>
                                <div class="col-sm-3" style="padding:0px;">
                                    <input type="checkbox" id="chkNotice2" onchange="checkNotice()" value="1"><label for="chkNotice2">護照影本電子檔</label>
                                </div>
                                <div class="col-sm-3" style="padding:0px;">
                                    <input type="checkbox" id="chkNotice3" onchange="checkNotice()" value="2"><label for="chkNotice3">醫事人員或公共衛生師中文證書電子檔</label>
                                </div>
                                <div class="col-sm-2" style="padding:0px;">
                                    <input type="checkbox" id="chkNotice4" onchange="checkNotice()" name="chkNotice" value="3"><label for="chkNotice4">其他</label>
                                </div>


                            </div>
                            <div class="form-group">
                                <label class="main-label col-sm-2" for="">補件內容</label>
                                <div class="col-sm-4">
                                    @Html.TextAreaFor(m => m.Note, new { @class = "form-control" })
                                </div>
                            </div>*@
                        </div>

                        <div id="mail_record" style="display:none">
                            <div class="form-group">
                                <label class="main-label col-sm-2" for="">郵寄日期</label>
                                <div class="col-sm-4">
                                    @Html.DatePickerTWFor(m => m.MAIL_DATE_AD, new { size = "10" })
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="main-label col-sm-2" for="">掛號條碼</label>
                                <div class="col-sm-4">
                                    @Html.TextBoxFor(m => m.MAIL_BARCODE, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>

                        <div class="form-group" style="display:none">
                            <label class="main-label col-sm-2" for="">公文文號</label>
                            <div class="col-sm-4">
                                @Html.TextBoxFor(m => m.MOHW_CASE_NO, new { @id = "MOHW_CASE_NO", @class = "form-control", placeholder = "" })
                            </div>
                            <button type="button" id="btnCaseNo" class="btn btn-blue" onclick="GetMOHW_CASE_NO('4','@Model.APP_ID')">取得公文文號</button>
                        </div>

                        <div class="form-group">
                            <label class="main-label col-sm-2" for="">案件歷程記錄</label>
                            <div class="col-sm-10">
                                @Html.LogForTurbo(Model.APP_ID, "APPLY_001008,APPLY_001008_TRANS,APPLY_001008_TRANSF,APPLY_PAY")
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="btn-bar text-center">
            <button type="button" id="btnSave" class="btn btn-save" onclick="doSave()">存檔</button>
            <button type="button" class="btn btn-gray" onclick="doBack()">返回</button>
        </div>
        @Html.HiddenFor(m => m.IsNotice)
        @Html.HiddenFor(m => m.NoticeCheck)
    </div>
}

<script type="text/javascript">
    $(document).ready(function () {
        var flowCD = '@Model.FLOW_CD';
        var isPay = '@Model.IsPay';
        var isNotice = '@Model.IsNotice';
        var noticeCheck = '@Model.NoticeCheck';

        $('#IsPay').on('change', clearPAYEXTTIME);

        //繳費情形
        if ($('#IsPay').is(':checked')) {
            $('#IsPay').attr('disabled', 'disabled');
            $('#PAY_MONEY').attr('readonly', 'readonly');
        }

        //案件進度歷程-案件進度
        var flowCDSelObj = $('#FLOW_CD option:selected');
        var flowCDSel = flowCDSelObj.val();
        $("#StatusDesc").val(flowCDSelObj.text());

        // 0:完成申請 9 逾期未補件而予結案 12 核可(發文歸檔) 15自請撤銷 8退件通知 就不能再存檔改資料
        if (flowCDSel == '0' || flowCDSel == '9' || flowCDSel == '12' || flowCDSel == '15' || flowCDSel == '8') {
            $('#FLOW_CD').attr('disabled', 'disabled');
            $('#MOHW_CASE_NO').attr("readonly", "readonly");
            $('#btnCaseNo').attr('disabled', 'disabled')

            //繳費情形
            $('#PAY_MONEY').attr("readonly", "readonly");
            $('#Apply_PAY_A_FEE').attr("readonly", "readonly");
            $('#PAY_ACT_TIME_AC_TW').attr("readonly", "readonly");
            $('#div[tagid="PAY_ACT_TIME_AC_TW"]').attr('disabled', 'disabled');
            $('#PAY_EXT_TIME_AC_TW').attr("readonly", "readonly");
            $('div[tagid="PAY_EXT_TIME_AC_TW"]').attr('disabled', 'disabled');
            $('#IsPay').attr('disabled', 'disabled');

            $('#btnSave').hide();
            $('#mail_record').hide();
        }

        if (flowCDSel == "2") {
            //通知補件
            $("input[id^=chkNotice]").prop("checked", false);
            if (noticeCheck != "") {
                var noticeAry = noticeCheck.split(',');
                if (noticeAry) {
                    for (var i = 0 ; i < noticeAry.length; i++) {
                        switch (noticeAry[i]) {
                            case "FILE_0":
                                $("#chkNotice1").prop("checked", true);
                                break;
                            case "FILE_1":
                                $("#chkNotice2").prop("checked", true);
                                break;
                            case "FILE_2":
                                $("#chkNotice3").prop("checked", true);
                                break;
                            case "ALL_3":
                                $("#chkNotice4").prop("checked", true);
                                break;
                        }
                    }
                }
            }
            $("input[id^=chkNotice]").prop("disabled", true);
            $("#Note").attr("readonly", "readonly");
        }

        if (flowCDSel == '2') {
            //通知補件
            $("input[id^=chkNotice]").attr("disabled", "disabled");
            $("#Note").attr("readonly", "readonly");

            $('#notice').show();
            $('#notice_item').show();
            $('#note_content').show();
            $('#remarkTitle').text('補件內容');

        }
        else if (flowCDSel == '9') {
            //9:逾期未補件而予結案
            $("input[id^=chkNotice]").attr("disabled", "disabled");
            $("#Note").attr("readonly", "readonly");
            $('#notice').show();
            $('#notice_item').hide();
            $('#note_content').show();
            $('#remarkTitle').text('備註');
        }
        else if (flowCDSel == '15') {
            //15:自請撤銷
            $("input[id^=chkNotice]").attr("disabled", "disabled");
            $("#Note").attr("readonly", "readonly");
            $('#notice').show();
            $('#notice_item').hide();
            $('#note_content').show();
            $('#remarkTitle').text('備註');
        }
        else if (flowCDSel == '12') {
            // 12:核可(發文歸檔)
            $('#mail_record').show();
            $('#notice').hide();
            $('#notice_item').hide();
            $('#note_content').hide();
            $('#remark').text('補件內容');

        }
        else if (flowCDSel == '8') {
            // 8:退件通知
            $("input[id^=chkNotice]").attr("disabled", "disabled");
            $("#Note").attr("readonly", "readonly");
            $('#notice').show();
            $('#notice_item').hide();
            $('#note_content').show();
            $('#remarkTitle').text('備註');
          }
        else {
            $('#notice').hide();
            $('#notice_item').hide();
            $('#note_content').hide();
            $('#remarkTitle').text('補件內容');
        }

        //resetHeightMe();
        //resetHeightPr();
    });

    // 送出
    function doSave() {
        var ValStr = "";
        if ($('#FLOW_CD option:selected').val() == "") {
            blockAlert("請選擇案件狀態 !", "提示訊息");
        }
        else {
            var data = getFormDataToObject($("form[id=main_form]"));
            var appID = '@Model.APP_ID';
            ajaxLoadMore('@Url.Action("Save")', data, function (retData) {
                if (retData.status) {
                    // 完成申請 逾期未補件而予結案 自請撤銷 退件通知 核可(發文歸檔)
                    var flowStatus = $('#Apply_FLOW_CD option:selected').val();
                    if (flowStatus == '0' || flowStatus == '9' || flowStatus == '15'
                        || flowStatus == '8' || flowStatus == '12') {
                        $('#btnSave').hide();
                        $('#FLOW_CD').attr('disabled', 'disabled');
                        $('#MOHW_CASE_NO').attr("readonly", "readonly");
                        $('#btnCaseNo').attr('disabled', 'disabled')
                        /*if ($('#FLOW_CD option:selected').val() == '2') {
                            $('#checkOne').attr('disabled', 'disabled');
                            $('#checkAll').attr('disabled', 'disabled');
                        }*/
                        $('#Note').attr('readonly', 'readonly');
                    }

                    if ($('#IsPay').is(':checked')) {
                        //有勾已繳費
                        $('#IsPay').attr('disabled', 'disabled');
                        $('#PAY_MONEY').attr('readonly', 'readonly');
                        $('#PAY_EXT_TIME_AD_TW').attr("readonly", "readonly");
                        $('div[tagid="PAY_EXT_TIME_AD_TW"]').attr('disabled', 'disabled');
                    }
                    blockMessage(retData.message, "提示訊息", function () {
                        blockUI();
                        location.href = '@Url.Action("Index", "Apply_001008")?appid=' + appID;
                    });

                }
                else {
                    blockAlert(retData.message, "提示訊息");
                }
            });
        }
    }

    // 返回
    function doBack() {
        location.href = '@Url.Action("Index", "Case")'
    }

    //繳費日期連動交易日期
    function dateTimePickerShowCallback() {
        $('#PAY_MONEY').val($('#Apply_PAY_A_FEE').val());
    }
    function clearPAYEXTTIME() {
        if ($('#IsPay').is(':checked') == false) {
            // 未勾選已繳費，繳費金額清空
            $('#PAY_MONEY').val('');
            $('#PAY_EXT_TIME_AC').val('');
            $('#PAY_EXT_TIME_AC_TW').val('');
        }
    }

    //「案件狀態修改」連動「案件進度」
    function changeAppDocCheck() {
        var flowCD = '@Model.FLOW_CD';
        var isPay = '@Model.IsPay';

        var flowCDSel = $('#FLOW_CD option:selected').val();
        if (flowCDSel == '0') {
            //0：完成申請
            $('#MOHW_CASE_NO').attr("readonly", "readonly");
            $('#btnCaseNo').attr('disabled', 'disabled')

            $('#notice').hide('slow');
            $('#notice_item').hide('slow');
            $('#note_content').hide('slow');
            $('#remarkTitle').text('補件內容');
        }
        else {
            if (flowCDSel != "0" && flowCDSel != "9"  && isPay != "Y") {
                //狀態不是選 完成申請(0)、逾期未補件而予結案(9)及 未註記已繳費時
                $('#PAY_MONEY').removeAttr("readonly");
                $('#PAY_EXT_TIME_AD_TW').removeAttr("readonly");
                $('div[tagid="PAY_EXT_TIME_AD_TW"]').removeAttr('disabled');
                $('#IsPay').removeAttr('disabled');
            }

            if (flowCDSel == '2') {
                //補件通知
                $('#mail_record').hide('slow');
                $('#notice').show('slow');
                $('#notice_item').show('slow');
                $('#note_content').show('slow');
                $('#remarkTitle').text('補件內容');
            }
            else if (flowCDSel == '9') {
                //逾期未補件而予結案
                $('#mail_record').hide('slow');
                $('#notice').show('slow');
                $('#notice_item').hide('slow');
                $('#note_content').show('slow');
                $('#Note').removeAttr('readonly');
                $('#Note').val('');
                $('#remarkTitle').text('備註');
            }
            else if (flowCDSel == '15') {
                //自請撤銷
                $('#mail_record').hide('slow');
                $('#notice').show('slow');
                $('#notice_item').hide('slow');
                $('#note_content').show('slow');
                $('#Note').removeAttr('readonly');
                $('#Note').val('');
                $('#remarkTitle').text('備註');
            }
            else if (flowCDSel == '8') {
                //退件通知
                $('#mail_record').hide('slow');
                $('#notice').show('slow');
                $('#notice_item').hide('slow');
                $('#note_content').show('slow');
                $('#Note').removeAttr('readonly');
                $('#Note').val('');
                $('#remarkTitle').text('備註');
            }
            else if (flowCDSel == '12') {
                // 核可(發文歸檔)
                $('#mail_record').show();
                $('#notice').hide();
                $('#notice_item').hide();
                $('#note_content').hide();
                $('#remark').text('備註');
            }
            else {
                $('#mail_record').hide('slow');
                $('#notice').hide('slow');
                $('#notice_item').hide('slow');
                $('#note_content').hide('slow');
                $('#remarkTitle').text('補件內容');
            }

            $('#MOHW_CASE_NO').removeAttr("readonly");
            $('#btnCaseNo').removeAttr('disabled')
        }

        $("#StatusDesc").val($('#FLOW_CD option:selected').text());
    }

    //確認補件項目
    function checkNotice() {
        var ValArr = new Array();
        //debugger;
        $('input[type="checkbox"][id^="chkNotice"]:checked').each(function (i) {
            ValArr[i] = this.value;
        });
        //debugger;
        $('#NoticeCheck').val(ValArr.join());
    }

    // 取得ZIP
    function GetZip(APP_ID) {
        var data = {
            "APP_ID": APP_ID,
            "CASENAME": "001008"
        }
        var url = '/GetZIP/GetZIP?' + $.param(data);
        location.href = url;
    }


</script>
